<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Remove White from Image</title>
<style>
  body { font-family: sans-serif; text-align: center; background: #111; color: #fff; }
  canvas { margin-top: 1rem; border: 1px solid #444; max-width: 90%; }
  button { margin: 1rem; padding: 0.5rem 1rem; }
</style>
</head>
<body>
  <h1>Remove White Background (#ffffff)</h1>
  <input type="file" id="upload" accept="image/jpeg,image/png"><br>
  <canvas id="canvas"></canvas><br>
  <button id="download" style="display:none;">Download PNG</button>

<script>
const upload = document.getElementById('upload');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const downloadBtn = document.getElementById('download');

upload.addEventListener('change', e => {
  const file = e.target.files[0];
  if (!file) return;

  const img = new Image();
  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);

    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = imageData.data;

    const tolerance = 250; // tolerance for "almost white" pixels
    for (let i = 0; i < data.length; i += 4) {
      const r = data[i], g = data[i + 1], b = data[i + 2];
      if (r >= tolerance && g >= tolerance && b >= tolerance) {
        data[i + 3] = 0; // make pixel transparent
      }
    }

    ctx.putImageData(imageData, 0, 0);

    // Show download button
    downloadBtn.style.display = 'inline-block';
  };
  img.src = URL.createObjectURL(file);
});

downloadBtn.addEventListener('click', () => {
  const pngUrl = canvas.toDataURL("image/png");
  const link = document.createElement('a');
  link.download = 'output.png';
  link.href = pngUrl;
  link.click();
});
</script>
</body>
</html>

